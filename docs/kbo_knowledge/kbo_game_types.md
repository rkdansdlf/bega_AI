# KBO 리그 경기 유형 정의서 (Game Types Definition)

## **[KBO 리그 5대 경기 유형 정의서]**

### 1. 개요
본 문서는 KBO 리그를 구성하는 5가지 경기 유형(시범경기, 정규시즌, 올스타전, 포스트시즌, 순위 결정전)의 정의와 시스템 처리 규칙을 기술한다. 챗봇은 현재 진행 중인 경기의 유형을 식별하여 적절한 규정과 맥락을 적용해야 한다.

### 2. 경기 유형별 상세 명세

#### Type 1: 시범경기 (Exhibition Game)
- **시기**: 3월 중순 ~ 3월 말 (정규시즌 개막 전)
- **목적**: 선수 컨디션 점검 및 신인 기량 테스트.
- **핵심 규정**:
    - **연장전 없음**: 9회까지 승부가 나지 않으면 무승부 종료.
    - **우천 취소**: 재편성되지 않고 소멸됨.
    - **비디오 판독**: 정규시즌과 동일하게 적용되나, 횟수 등은 유동적일 수 있음.
- **챗봇 대응 로직**:
    - **데이터 가중치**: 낮음 (이 기록은 정규시즌/통산 기록에 포함되지 않음).
    - **페르소나**: "결과보다는 과정이 중요합니다. 유망주를 지켜보세요."
    - **주의사항**: 시범경기 1위를 했다고 해서 정규시즌 우승을 보장하지 않음을 명시(설레발 방지).

#### Type 2: 정규시즌 (Regular Season)
- **시기**: 3월 말/4월 초 ~ 9월 말 (메인 시즌)
- **규모**: 팀당 144경기 (총 720경기).
- **목적**: 포스트시즌 진출팀(1~5위) 결정.
- **핵심 규정**:
    - **연장전**: 12회말까지 진행 (승부 안 날 시 무승부).
    - **더블헤더**: 우천 취소 시 1일 2경기 편성 가능.
    - **순위 산정**: 승률($\frac{승}{승+패}$) 우선.
- **챗봇 대응 로직**:
    - **데이터 가중치**: 높음 (공식 기록의 기준).
    - **주요 쿼리**: 선발 투수, 승패 결과, 순위 변동, 개인 타이틀 경쟁.
    - **답변 포인트**: 연승/연패 흐름과 '게임차'를 중심으로 순위 경쟁 상황 전달.

#### Type 3: 올스타전 (All-Star Game)
- **시기**: 7월 중순 (전반기 종료 후 브레이크 기간)
- **구성**: 드림 올스타 vs 나눔 올스타.
- **목적**: 팬들을 위한 축제 및 이벤트.
- **핵심 규정**:
    - **승패 무관**: 기록이 정규시즌에 반영되지 않음.
    - **이벤트**: 홈런 레이스, 퍼펙트 피처 등 부대 행사 존재.
    - **베스트 12**: 팬 투표와 선수단 투표로 선정.
- **챗봇 대응 로직**:
    - **톤앤매너**: 즐겁고 축제 같은 분위기.
    - **주요 정보**: "올해 베스트 12 누구야?", "유니폼 퍼포먼스 뭐 했어?"
    - **데이터 처리**: 정규 기록과 분리하여 이벤트성 데이터로 저장.

#### Type 4: 포스트시즌 (Postseason)
- **시기**: 10월 ~ 11월 (가을야구)
- **구성**: 와일드카드(WC) $\rightarrow$ 준플레이오프(Semi-PO) $\rightarrow$ 플레이오프(PO) $\rightarrow$ 한국시리즈(KS).
- **목적**: 최종 우승팀 결정.
- **핵심 규정**:
    - **연장전**: 15회말까지 진행 (정규시즌보다 3이닝 연장).
    - **무승부 시**: 승부가 날 때까지 시리즈가 계속됨 (예: 7전 4선승제가 무승부 포함 시 8차전까지 갈 수 있음).
    - **엔트리**: 시리즈별로 엔트리 변경 가능.
- **챗봇 대응 로직**:
    - **긴장감**: 최대치 ("한 경기 한 경기가 벼랑 끝 승부입니다.").
    - **시리즈 스코어**: "지금 2승 1패로 삼성이 앞서고 있습니다" 등 시리즈 전황 브리핑 필수.
    - **MVP**: 데일리 MVP 및 시리즈 MVP 정보 제공.

#### Type 5: 순위 결정전 (Tie-breaker)
- **시기**: 정규시즌 종료 시점 (매우 희귀함)
- **발생 조건**:
    - **1위 결정전**: 1위 팀이 두 팀이고 승률이 동률일 때.
    - **5위 결정전**: 5위 팀(포스트시즌 막차)이 두 팀이고 승률이 동률일 때.
    - (참고: 2, 3, 4위 동률은 상대 전적 등으로 순위 매김, 경기 안 함)
- **핵심 규정**:
    - **무제한 연장**: 끝장 승부. 승패가 갈릴 때까지 이닝 제한 없이 경기 진행.
    - **기록**: 정규시즌 기록에 포함됨 (선수 개인 스탯 인정).
- **챗봇 대응 로직**:
    - **희소성 강조**: "역대급 사건이 터졌습니다. 오늘 이기는 팀이 모든 것을 가져갑니다."
    - **규정 안내**: "오늘은 무승부가 없습니다. 밤을 새워서라도 승부를 냅니다."

---

## **[DB `league_type_code` 매핑]**

### 1. 개요
본 문서는 `kbo_seasons` 테이블의 `league_type_code` 컬럼에 저장된 6가지(0~5) 경기 유형의 정의와 시스템 처리 규칙을 기술한다. 챗봇은 이 코드를 기준으로 경기 규정(연장전, 무승부 등)과 답변의 페르소나를 결정해야 한다.

### 2. DB 코드별 상세 명세 (Code Mapping)
이미지 데이터를 분석한 결과, 코드는 **0(정규시즌)**, **1(시범경기)**, 그리고 **2~5(포스트시즌 단계)**로 구성되어 있습니다.

| 코드 (`int4`) | 명칭 (`varchar`) | 분류 | 핵심 특징 | 데이터 처리 |
| :---: | :--- | :--- | :--- | :--- |
| **1** | **시범경기** | 프리시즌 | 연습 경기, 정규 기록 미포함 | 가중치 낮음 |
| **0** | **정규시즌** | 메인 시즌 | 팀당 144경기, 순위 경쟁 | **기준 데이터** |
| **2** | **와일드카드** | PS (가을야구) | 4위 vs 5위 (최대 2경기) | 별도 집계 |
| **3** | **준플레이오프** | PS (가을야구) | 5전 3선승제 | 별도 집계 |
| **4** | **플레이오프** | PS (가을야구) | 5전 3선승제 | 별도 집계 |
| **5** | **한국시리즈** | PS (가을야구) | 7전 4선승제 (최종 결승) | 별도 집계 |

---

### 3. 유형별 상세 규정 및 챗봇 로직

#### Code 1: 시범경기 (Exhibition Game)
- **정의**: 정규시즌 개막 전(3월 중순)에 치르는 연습 경기.
- **규정**:
    - 연장전 없음 (9회 종료).
    - 우천 취소 시 재경기 없음.
- **챗봇 멘트**: "아직 몸 푸는 단계입니다. 승패보다는 신인 선수들의 활약을 지켜보세요." (설레발 방지)

#### Code 0: 정규시즌 (Regular Season)
- **정의**: 144경기를 치르는 대장정. 모든 공식 기록의 기준.
- **규정**:
    - 최대 12회까지 연장 진행 (12회말 종료 시 동점이면 무승부).
    - 우천 취소 시 추후 편성 (더블헤더 가능).
- **챗봇 멘트**: "오늘 승리로 3연승을 달립니다!", "게임차가 0.5경기 줄었습니다." (순위 경쟁 강조)

#### Code 2: 와일드카드 결정전 (Wild Card)
- **정의**: 4위(1승 어드밴티지) vs 5위 대결.
- **규정**:
    - **4위 팀**: 비기거나 이기면 바로 진출 (1경기 종료).
    - **5위 팀**: 반드시 2경기를 모두 이겨야 진출.
    - 최대 15회 연장.
- **챗봇 멘트**: "5위 팀에게는 내일이 없습니다. 무조건 이겨야 하는 벼랑 끝 승부입니다."

#### Code 3, 4: 준플레이오프 / 플레이오프 (Semi-PO / PO)
- **정의**: 상위 라운드 진출을 위한 토너먼트. (Code 3: WC승자 vs 3위 / Code 4: 준PO승자 vs 2위)
- **규정**:
    - 5전 3선승제.
    - 최대 15회 연장. 무승부 시 시리즈가 길어질 수 있음.
- **챗봇 멘트**: "시리즈 전적 O승 O패! 이제 1승만 더하면 다음 라운드로 갑니다."

#### Code 5: 한국시리즈 (Korean Series)
- **정의**: 시즌 최종 우승 팀을 가리는 결승전. (PO승자 vs 1위)
- **규정**:
    - 7전 4선승제.
    - 최대 15회 연장 (무승부 시 최대 횟수 없이 끝장 승부 규정이 적용될 때도 있음 - 연도별 상이).
- **챗봇 멘트**: "올해의 챔피언을 결정짓는 순간입니다! 통합 우승이 눈앞에 있습니다."

---

### 4. 시스템 구현 가이드 (Developer Note)

#### 4.1 포스트시즌 그룹화 로직
DB에는 포스트시즌이 2, 3, 4, 5로 쪼개져 있으므로, 챗봇 로직에서는 이를 묶어서 처리하는 헬퍼 함수가 필요합니다.

```python
def get_game_context(league_type_code):
    """
    league_type_code (int): 0~5
    """
    if league_type_code == 0:
        return "REGULAR_SEASON" # 정규시즌 로직 (무승부 O, 12회)
    
    elif league_type_code == 1:
        return "EXHIBITION" # 시범경기 로직 (무승부 O, 9회, 기록X)
    
    elif league_type_code >= 2 and league_type_code <= 5:
        return "POST_SEASON" # 가을야구 로직 (무승부 O, 15회, 기록 별도)
    
    else:
        return "UNKNOWN"
```

#### 4.2 DB 조회 시 주의사항 (SQL)
사용자가 "김현수 포스트시즌 기록 알려줘"라고 물으면, `league_type_code`가 **2, 3, 4, 5인 데이터를 모두 합산(`SUM`)**해서 보여줘야 합니다.

```sql
-- 예시: 특정 선수의 통산 포스트시즌 홈런 수 조회
SELECT SUM(hr) 
FROM player_stats 
WHERE player_id = 'kim_hyun_soo' 
  AND league_type_code IN (2, 3, 4, 5); -- 0(정규시즌)과 1(시범경기)은 제외
```

#### 4.3 참고: 올스타전 및 순위결정전
- 현재 제공해주신 `kbo_seasons` 테이블 코드(0~5)에는 **올스타전**과 **순위결정전(타이브레이커)** 코드가 보이지 않습니다.
- 만약 해당 경기 데이터가 발생한다면, 별도 코드를 부여하거나(예: 6, 7), 이벤트성 경기이므로 별도 테이블로 관리하는지 확인이 필요합니다. (현재 로직에서는 0~5 범위 내에서만 대응하도록 설계)
